## OZON-MoySklad_server

### Словарь параметров API МойСклад
- **organization** - мета-данные юрлица
- **store** - мета-данные склада
- **retailStore** - мета-данные точки продаж
- **retailShift** - мета-данные смены для розничной продажи: открываю смену через API, получаю эти мета-данные 
- **name** - номер смены, порядковое пятизначное число с ведущими нулями, которое назначается сервером автоматически при создании смены. имеет сквозную нумерацию.

### Словарь параметров API OZON
Структура Json заказов - [0] в структуре означает наличие индексированного списка
- response['result'][0]['order_id] - **Номер заказа**
- response['result'][0]['products'][0]['offer_id'] - **Артикул товара в заказе**
- response['result'][0]['products'][0]['created_at'] - **Время оформления заказа**
- response['result'][0]['products'][0]['price'] - **Цена продажи товара**
- response['result'][0]['products'][0]['sku'] - **SKU** - он же product_id из financial_data
- response['result'][0]['financial_data']['products'][0]['product_id'] - **product_id** - он же SKU в списке товаров в заказе
- response['result'][0]['financial_data']['products'][0]['commission_amount'] - **Комиссия с продажи товара (в руб.)**
- response['result'][0]['financial_data']['products'][0]['item_services']{нужно забрать все значения из словаря} - **Списания ОЗОН за логистику** и т.п. (в минус руб.)

### Доступные статусы заказа OZON
- delivered
- cancelled
- delivering
- awaiting_deliver
- awaiting_packaging

### Задачи
- [x] Открыть смену и получить ее ID и имя (порядковый номер)
- [x] Получить от ОЗОН список всех заказов
- [x] Сформировать цикл, проходящий по всем заказам из выгрузки с ОЗОН
- [x] Перенести файл */meta/moysklad-meta.json* в папку */api-keys/*
- [ ] В цикле получить все необходимые данные о заказе и сформировать соответствующий json-объект. Этот json-объект должен соответствовать API МойСклад. Возможно, вместо большого json-объекта со всеми заказами, нужно отправлять в API МойСклад каждый заказ отдельно. По очереди в том же цикле с задержкой в 10 секунд с помощью sleep.
- [ ] Закрыть смену все же ВОЗМОЖНО! Для этого необходимо изменить смену с указанием Даты/Времени закрытия. Поэтому необходимо создать управляющий скрипт, который будет вызывать функцию открытия и закрытия смены.
- [ ] Выбрать какое-либо поле в заказах на МойСклад, в которое можно будет сохранять **номер** заказа из системы ОЗОН
- [ ] Выбрать какое-либо поле в заказах на МойСклад, в которое можно будет сохранять **статус** заказа из системы ОЗОН
- [ ] Создать скрипт, который будет получать из МойСклад все ранее выгруженные закзаы со статусом *delivering*, *awaiting_deliver* и *awaiting_pachaging* за 45 дней. Далее необходимо найти их среди заказов ОЗОН за последние 45 дней и проверить не изменился ли статус. Если статус обновился - обновить его и в МойСклад.
- [ ] Создать полноценный модуль регулярной обработки полученных из OZON заказов, и отправки их в открытую смену.


### Скрытые файлы
- Схема файлов с апи ключами и секретными мета-данными, скрытых в .gitignore находится в папке **/scheme/**
- тильда в названии папок *~api-keys* и *~meta* обозначает, что рабочие версии этих папок указаны в .gitignore
- папка *data* содержит резервную копию (шаблон) рабочих файлов данных на случай необходимости их восстановления после утраты

